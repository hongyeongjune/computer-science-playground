## JVM
![images](https://fascinated-game-c50.notion.site/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F71d6eb77-dd55-46ce-ac7f-e7aa763fb601%2FUntitled.png?table=block&id=2c0ceca2-5f42-451e-9468-d00da8fc163e&spaceId=388b68a4-8d73-4550-857a-eae96c4971c9&width=1510&userId=&cache=v2)
* 동작과정
    - 작성한 자바 소스를 자바 컴파일러를 통해 자바 바이트 코드로 변환
    - 컴파일된 바이트 코드를 JVM 의 클래스로더에게 전달
    - 클래스로더는 클래스를 로딩하여 런타임 데이터 영역에 메모리를 올린다.
    - 실행 엔진은 JVM 메모리에 올라온 바이트 코드들을 명령어 단위로 하나씩 가져와서 실행
        - 인터프리터 방식, JIT 방식으로 동작
* JVM(Java Virtual Machine)은 자바가 환경에 종속되지 않고 실행할 수 있게 해주는 가상머신
* 구성요소
    - Class Loader
        - RunTime 시점에 클래스를 로딩하게 해주며 컴파일러가 변환한 바이트 코드를 JVM 에 로드하는 역할
    - Runtime Data Area
        - 클래스 로더가 로드해온 정보들은 런타임 데이터 영역에 저장하는데, 5가지 영역이 있다.
            - 각 스레다마다 고유하게 생성되며 스레드 종료 시 소멸되는 Stack
                - PC Register
                    - Thread 가 시작될 때, 각각의 Thread 별로 생성되는 공간으로 현재 수행 중인 JVM 명령어 주소를 가지게 된다.
                - JVM Stack Area
                    - 프로그램의 실행 과정에서 임시로 할당되었다가 메소드를 빠져나가면 바로 소멸되는 특성의 데이터를 저장하기 위한 영역이다.
                    - 메소드의 매개변수, 지역 변수 등 메소드의 정보를 저장한다.
                    - 쓰레드 마다 런타임 스택을 만들고, 그 안에 메소드 호출을 스택 프레임이라 부르는 블럭으로 쌓는다. 쓰레드가 종료되면 스택도 사라진다.
                - Native Method Stack
                    - 자바가 아닌 다른 언어로 작성된 코드를 위한 Stack
                    - 자바 프로그램이 컴파일되어 생성되는 바이트 코드가 아닌 실제 실행할 수 있는 기계어로 작성된 프로그램을 실행시키는 영역
        - 모든 쓰레드가 공유하는 메모리 영역
            - Method Area
                - 클래스 로더가 클래스 파일을 읽어오면, 클래스 정보를 파싱해서 저장하는 곳 (Class Data 저장)
                - 클래스, 인터페이스, 메소드, 필드, Static 변수 등의 바이트 코드를 보관한다.
            - Heap
                - 객체의 인스턴스를 저장하는 영역(동적으로 생성된 객체)
                - GC 의 대상이 되는 영역
    - Execution Engine
        - 클래스를 실행시키는 역할
        - 클래스로더가 JVM 내의 런타임 데이터 영역에 바이트 코드를 배치하고 이것은 실행 엔진에 의해서 실행
        - 실행 엔진은 바이트 코드를 명령어 단위로 읽어서 실행
        - 최초의 JVM 은 인터프리터 방식이었기 때문에 속도가 느린 단점이 존재 -> JIT 컴파일러를 도입하여 단점을 보완
        - 자바 인터프리터
            - 바이트 코드 명령어를 하나씩 읽어서 해석하고 실행
            - 하나하나 실행은 빠르나 전체적인 실행은 느리다.
        - JIT 컴파일러
            - 인터프리터의 단점을 보완하기 위해 도입
            - 반복된 메서드 호출이 발생하면, 바이트 코드 전체를 바이너리 코드로 변경하고 이후에는 해당 메서드를 더이상 인터프리팅하지 않고 바이너리 코드로 직접 실행하는 방식
            - 전체적인 실행 속도는 인터프리터 보다 빠르다.
            - 즉, 인터프리터 방식으로 실행하다가 적절한 시점에 JIT 컴파일러로 바이트 코드 전체를 컴파일하여 네이티브 코드로 변경하고 그 이후에는 더 이상 인터프리팅 하지 않고 네이티브 코드로 직접 실행하는 방식