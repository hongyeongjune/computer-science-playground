## NginX
* 경량 웹 서버
* 클라이언트로부터 요청을 받았을 때 요청에 맞는 정적 파일을 응답해주는 HTTP Web Server 로 활용되고,
* Reverse Proxy Server 로 활용하여 WAS 서버의 부하를 줄일 수 있는 로드 밸런서 역할로 활용되기도 한다.
* 특징
    - Event-Driven 구조로 동작하기 때문에 한 개 또는 고정된 프로세스만 생성하여 사용하고 비동기 방식으로 요청들을 동시(Concurrency)에 처리할 수 있다.
    - 요청마다 새로운 프로세스와 스레드를 생성하지 않기 때문에 생성 비용이 존재하지 않고 적은 자원으로 효율적인 운용 가능 -> 대용량 처리에 적합
    - 커넥션을 전부 이벤트 핸들러를 통해 비동기 방식으로 처리
    - 동작 과정
        - 사전에 서버 개발자가 정한 스레드 개수를 생성하고 해당 자원만을 가지고 HTTP 요청을 처리
        - Event-Driven 구조로 동작하기 때문에 요청을 처리할 때 다른 작업이 끝남을 기다리지 않고 비동기 방식으로 동작
        - Event-Driven 구조 동작 방식
            - Nginx 는 요청에 대한 작업을 처리할 때, CPU 가 관여하지 않는 작업(I/O, socket read/write)을 하면 이거는 스레드가 작업 하지 않고 이벤트 핸들러라는 곳으로 보내 작업한다.
            - 이벤트 핸들러는 작업을 마치게 되면 작업이 완료된 순서대로 큐에 보관
            - 매번 이벤트 루프가 큐를 확인하면서 완료된 작업이 있는지 확인
            - 큐에 있는 값을 응답
* 그래서 nginx 는 도대체 어떻게 싱글 스레드로 대용량의 효율을 뽑아내는가?
    - 하나의 master 프로세스에서 고정된 수의 worker 프로세스(보통 cpu 코어 개수 만큼 생성)만을 관리
    - 이 프로세스는 block 되지 않고 listen 소켓과 connection 소켓의 이벤트를 기반으로 non-blocking 으로 동작한다.
    - 즉, 이 worker 프로세스들이 listen socket, connection socket 2개의 이벤트를 다 처리한다.
    - 이벤트 주도 방식이 왜 더 빠른가요?
        - 메모리에 프로세스, 스레드를 생성하기 위한 공간이 필요하다.
        - 해당 프로세스나 스레드를 관리하기 위해서는 추가적인 CPU 작업이 필요하다.
        - 그 수가 많아질수록 context-switching 이 많아진다.
    - 매번 connection 마다 프로세스나 스레드를 생성하지 말고 고정된 수의 프로세스로 여러 connection 을 처리하기 위해 이벤트가 발생할 때마다 처리해주는 방식으로 동작
    - worker 프로세스는 nginx 설정에 따라 초기화되고 master process 에 의해 listen socket 을 제공받는다.
    - 새로운 connection 이 들어오면 이벤트가 발생하고 connection 종류에 따라 알맞은 기계 상태가 할당된다.
        - Http State machine
        - Stream State machine
            - raw TCP
        - Mail state machine
            - SMTP
            - IMAP
            - POP3

## Apache
* Apache : 멀티 프로세스 모듈(MPM) 방식
    - PreFork MPM (다중 프로세스 방식)
        - Client 요청에 대해 자식 프로세스를 생성하여 처리
        - default
        - 하나의 자식 프로세스당 하나의 스레드를 갖는다. (최대 1024개)
        - 스레드간 메모리 공유 x -> 독립적이기에 안정적이지만, 메모리 소모가 크다
    - Worker MPM (멀티 프로세스-스레드 방식)
        - PreFork 보다 메모리 사용량이 적고 동시접속자가 많은 사이트에 사용
        - 각 프로세스의 스레드를 생성해 처리하는 구조
        - 스레드 간 메모리 공유가 가능
        - 프로세스 당 최대 64개의 스레드 처리가 가능 -> 각 스레드는 하나의 연결만을 부여 받음